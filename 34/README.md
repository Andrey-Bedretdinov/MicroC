# Объяснение кода: Реализация ШИМ (PWM) на таймере

Этот код настраивает генерацию ШИМ-сигнала с использованием таймера `Timer1` в режиме Fast PWM. Выход сигнала осуществляется на пине `PB1` (вывод `OC1A`), а коэффициент заполнения установлен на 25%.

---

## Основные параметры

1. **Частота процессора**: `F_CPU = 8 МГц`.
2. **Режим работы таймера**: Fast PWM (8 бит).
3. **Коэффициент заполнения**: `PWM_DUTY_CYCLE = 64` (64/255 ≈ 0.25).
4. **Режим вывода**: Неинвертирующий (сигнал активен на уровне лог. 1).

---

## Настройка ШИМ

### Конфигурация выхода `PB1`

```c
DDRB |= (1 << PB1);
```

- Устанавливает пин `PB1` как выходной для генерации ШИМ-сигнала.

---

### Режим работы таймера

#### Регистр `TCCR1A`

```c
TCCR1A = PWM_NON_INVERTING | PWM_FAST_MODE;
```

1. **`COM1A1`** (неинвертирующий режим):
    - Коэффициент заполнения задает уровень лог. 1.
    - Сигнал активен на уровне лог. 1, а затем сбрасывается.

2. **`WGM10` и `WGM12`** (Fast PWM, 8 бит):
    - Счет таймера идет от `0` до `255`, после чего он сбрасывается.

---

#### Регистр `TCCR1B`

```c
TCCR1B = TIMER_NO_PRESCALER | PWM_FAST_MODE;
```

1. **`CS10`**:
    - Устанавливает предделитель в 1 (таймер работает на полной частоте `F_CPU`).
2. **`WGM12`**:
    - Продолжает настройку режима Fast PWM.

---

### Установка коэффициента заполнения

```c
OCR1A = PWM_DUTY_CYCLE;
```

- Регистр `OCR1A` определяет момент переключения состояния выхода `OC1A`.
- Значение `OCR1A = 64` соответствует 25% заполнения (64/255).

---

## Режим работы Fast PWM

1. **Режим работы таймера**:
    - Таймер считает от `0` до `255` (8 бит).
    - При достижении значения `OCR1A` состояние выхода переключается.

2. **Коэффициент заполнения**:
    - Коэффициент заполнения рассчитывается по формуле: duty_cycle = (OCR1A / 255).
    - Для `OCR1A = 64`: duty_cycle = 64 / 255 ≈ 0.25.

3. **Частота сигнала**:
    - Частота ШИМ определяется по формуле: F_pwm = F_CPU / (N * 256), где `N` — предделитель.
    - В данном случае: F_pwm = 8 МГц / (1 * 256) = 31.25 кГц.

---

## Основной цикл

```c
while (1);
```

- Основной цикл пуст, так как таймер автоматически генерирует ШИМ-сигнал.

---

## Использованные регистры

1. **`DDRB`**:
    - Настройка пина `PB1` как выхода.
2. **`TCCR1A`**:
    - `COM1A1`: Неинвертирующий режим.
    - `WGM10`: Режим Fast PWM.
3. **`TCCR1B`**:
    - `CS10`: Предделитель в 1.
    - `WGM12`: Режим Fast PWM.
4. **`OCR1A`**:
    - Устанавливает коэффициент заполнения.

---

## Итоговая схема работы

1. **Режим Fast PWM**:
    - Таймер считает от `0` до `255`.
    - Состояние пина `PB1` переключается при достижении значения `OCR1A`.

2. **ШИМ-сигнал**:
    - Частота ШИМ составляет 31.25 кГц.
    - Коэффициент заполнения 25% задается через `OCR1A`.

3. **Применение**:
    - Этот код можно использовать для управления яркостью светодиодов, скоростью вращения двигателей и других задач, связанных с ШИМ.